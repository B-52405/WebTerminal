var Fe=Object.defineProperty;var Pe=(u,r,a)=>r in u?Fe(u,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):u[r]=a;var h=(u,r,a)=>(Pe(u,typeof r!="symbol"?r+"":r,a),a),I=(u,r,a)=>{if(!r.has(u))throw TypeError("Cannot "+a)};var f=(u,r,a)=>(I(u,r,"read from private field"),a?a.call(u):r.get(u)),d=(u,r,a)=>{if(r.has(u))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(u):r.set(u,a)},F=(u,r,a,j)=>(I(u,r,"write to private field"),j?j.call(u,a):r.set(u,a),a);var P=(u,r,a)=>(I(u,r,"access private method"),a);(function(u,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],r):(u=typeof globalThis<"u"?globalThis:u||self,r(u.WebTerminal={},u.Vue))})(this,function(u,r){var O,U,w,p,g,_,y,m;"use strict";function a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var j=Object.prototype.toString,W=function(t){if(t===void 0)return"undefined";if(t===null)return"null";var n=typeof t;if(n==="boolean")return"boolean";if(n==="string")return"string";if(n==="number")return"number";if(n==="symbol")return"symbol";if(n==="function")return v(t)?"generatorfunction":"function";if(q(t))return"array";if(ne(t))return"buffer";if(te(t))return"arguments";if(X(t))return"date";if(Q(t))return"error";if(Z(t))return"regexp";switch($(t)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(ee(t))return"generator";switch(n=j.call(t),n){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return n.slice(8,-1).toLowerCase().replace(/\s/g,"")};function $(e){return typeof e.constructor=="function"?e.constructor.name:null}function q(e){return Array.isArray?Array.isArray(e):e instanceof Array}function Q(e){return e instanceof Error||typeof e.message=="string"&&e.constructor&&typeof e.constructor.stackTraceLimit=="number"}function X(e){return e instanceof Date?!0:typeof e.toDateString=="function"&&typeof e.getDate=="function"&&typeof e.setDate=="function"}function Z(e){return e instanceof RegExp?!0:typeof e.flags=="string"&&typeof e.ignoreCase=="boolean"&&typeof e.multiline=="boolean"&&typeof e.global=="boolean"}function v(e,t){return $(e)==="GeneratorFunction"}function ee(e){return typeof e.throw=="function"&&typeof e.return=="function"&&typeof e.next=="function"}function te(e){try{if(typeof e.length=="number"&&typeof e.callee=="function")return!0}catch(t){if(t.message.indexOf("callee")!==-1)return!0}return!1}function ne(e){return e.constructor&&typeof e.constructor.isBuffer=="function"?e.constructor.isBuffer(e):!1}/*!
 * shallow-clone <https://github.com/jonschlinkert/shallow-clone>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Released under the MIT License.
 */const M=Symbol.prototype.valueOf,re=W;function ie(e,t){switch(re(e)){case"array":return e.slice();case"object":return Object.assign({},e);case"date":return new e.constructor(Number(e));case"map":return new Map(e);case"set":return new Set(e);case"buffer":return le(e);case"symbol":return ue(e);case"arraybuffer":return se(e);case"float32array":case"float64array":case"int16array":case"int32array":case"int8array":case"uint16array":case"uint32array":case"uint8clampedarray":case"uint8array":return ce(e);case"regexp":return oe(e);case"error":return Object.create(e);default:return e}}function oe(e){const t=e.flags!==void 0?e.flags:/\w+$/.exec(e)||void 0,n=new e.constructor(e.source,t);return n.lastIndex=e.lastIndex,n}function se(e){const t=new e.constructor(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t}function ce(e,t){return new e.constructor(e.buffer,e.byteOffset,e.length)}function le(e){const t=e.length,n=Buffer.allocUnsafe?Buffer.allocUnsafe(t):Buffer.from(t);return e.copy(n),n}function ue(e){return M?Object(M.call(e)):{}}var fe=ie;/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var ae=function(t){return t!=null&&typeof t=="object"&&Array.isArray(t)===!1};/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var he=ae;function G(e){return he(e)===!0&&Object.prototype.toString.call(e)==="[object Object]"}var me=function(t){var n,i;return!(G(t)===!1||(n=t.constructor,typeof n!="function")||(i=n.prototype,G(i)===!1)||i.hasOwnProperty("isPrototypeOf")===!1)};const de=fe,pe=W,ge=me;function E(e,t){switch(pe(e)){case"object":return _e(e,t);case"array":return ye(e,t);default:return de(e)}}function _e(e,t){if(typeof t=="function")return t(e);if(t||ge(e)){const n=new e.constructor;for(let i in e)n[i]=E(e[i],t);return n}return e}function ye(e,t){const n=new e.constructor(e.length);for(let i=0;i<e.length;i++)n[i]=E(e[i],t);return n}var be=E;const A=a(be),x=Object.freeze({BLACK:"black",BLUE:"blue",GREEN:"green",RED:"red",YELLOW:"yellow",WHITE:"white",ORANGR:"orange",GRAY:"#282828"}),we=10.8;class B{constructor(){h(this,"text","");h(this,"cls",[]);h(this,"style",{});h(this,"click");arguments.length>0&&(this.text=arguments[0])}Text(t){return this.text=t,this}Clss(t){return this.cls=t,this}Cls(t){return this.cls.push(t),this}Style(t){return this.style=t,this}Property(t,n){return this.style[t]=n,this}Click(t){return this.click=t,this}get length(){return this.text.length}copy(){return new B().Text(this.text).Clss(A(this.cls)).Style(A(this.style)).Click(this.click)}slice(t,n){t===void 0&&(t=0),n===void 0&&(n=this.length);const i=this.copy();return i.text=i.text.slice(t,n),i}warning(t){return this.text=t,this.style={color:x.ORANGR},this}error(t){return this.text=t,this.style={color:x.RED},this}red(){this.style.color=x.RED}}function k(){return arguments.length===0?new B:new B().Text(arguments[0])}const Ue="",K=(e,t)=>{const n=e.__vccOpts||e;for(const[i,s]of t)n[i]=s;return n},xe={props:{log_line:Array,terminal_line_length:Number,cursor_index:Number},computed:{lines(){let e=this.terminal_line_length,t=[[]];if(this.log_line.forEach(n=>{if(e==0&&(t.push([]),e=this.terminal_line_length),n.length>e){const i=n.slice(0,e);let s=n.slice(e);for(t[t.length-1].push(i);s.length>this.terminal_line_length;)t.push([s.slice(0,this.terminal_line_length)]),s=s.slice(this.terminal_line_length);t.push([s]),e=this.terminal_line_length-n.length+e}else t[t.length-1].push(n.copy()),e-=n.length}),this.cursor_index===void 0)return t;if(this.cursor_index===0){const n=t[t.length-1],i=k(" ").Cls("cursor");return n.push(i),t}else{let n=this.cursor_index;for(let i=t.length-1;i>=0;i--){const s=t[i];for(let o=s.length-1;o>=0;o--){const c=s[o];if(c.length>=n){const l=c.length-n,b=c.slice(0,l),R=c.slice(l,l+1).Cls("cursor"),N=c.slice(l+1);return s.splice(o,1,b,R,N),t}else n-=c.length}}}return t}}},ke={class:"log_line"},Oe=["onClick"];function je(e,t,n,i,s,o){return r.openBlock(),r.createElementBlock("div",null,[(r.openBlock(!0),r.createElementBlock(r.Fragment,null,r.renderList(o.lines,c=>(r.openBlock(),r.createElementBlock("div",ke,[(r.openBlock(!0),r.createElementBlock(r.Fragment,null,r.renderList(c,({text:l,cls:b,style:R,click:N})=>(r.openBlock(),r.createElementBlock("p",{class:r.normalizeClass(["clause",b]),style:r.normalizeStyle(R),onClick:N},r.toDisplayString(l),15,Oe))),256))]))),256))])}const Ae=K(xe,[["render",je],["__scopeId","data-v-94e9d509"]]);let S=console.log;function Be(e){typeof e=="function"&&(S=e)}function T(e,t){for(let n of e)S(n);typeof t=="function"&&t()}function C(e,t){T([e],t)}async function Ee(e,t){for(;;){const{value:n,done:i}=await e.next();if(i)break;S(n)}typeof t=="function"&&t()}function z(e){return Array.isArray(e)&&e.length>0}function H(e){return typeof e=="object"&&Object.keys(e).length>0}function Se(e){return e==null||typeof e!="object"&&typeof e!="function"||typeof e.next!="function"||typeof e[Symbol.iterator]!="function"?!1:e[Symbol.iterator]()===e}function Te(e){return function(t){for(const n in e)t[n]===void 0&&(t[n]=A(e[n]))}}class Ce{constructor(){d(this,O);h(this,"commands",{})}Command(t){const n=new De(t);return this.commands[t.toLowerCase()]=n,n}Remove(t){delete this.commands[t]}complete(t){if(P(this,O,U).call(this,t).length!==1)return[];{const n=[],i=t.toLowerCase();for(let s in this.commands)s.startsWith(i)&&n.push(this.commands[s].name);return n.sort()}}execute(t){const n=P(this,O,U).call(this,t);if(n.length===0)return;const i=this.commands[n[0]];if(i===void 0){T(["","  No such command.","  Try 'help' for assistance.",""]);return}i.call(n.slice(1))}help(t){if(t===void 0){const s=["","Commands:"];for(const o in this.commands){const c=this.commands[o];let l=`  ${c.name}`;l+=" ".repeat(D-l.length)+c.description,s.push(l)}return s.push(""),s}if(!(t in this.commands))return["","  No such command.",""];const n=[""],i=this.commands[t];if(i.description!==void 0&&(n.push("Description:"),n.push(`  ${i.description}`),n.push("")),H(i.params)){n.push("Params:");for(const s in i.params){const o=i.params[s];let c=`  ${o.name}`;c+=" ".repeat(V-c.length)+o.type,c+=" ".repeat(D-c.length)+o.description,o.default!==void 0&&(c+=`(default: ${JSON.stringify(o.default)})`),n.push(c)}n.push("")}if(H(i.options)){n.push("Options:");for(const s in i.options){const o=i.options[s];let c="  ";"short"in o&&(c+=`-${o.short}, `),c+=`--${o.name}`,c+=" ".repeat(V-c.length)+o.type,c+=" ".repeat(D-c.length)+o.description,o.default!==void 0&&(c+=`(default: ${JSON.stringify(o.default)})`),n.push(c)}n.push("")}return n.length===0&&(n.push("No description, no parama, no options, nothing."),n.push("")),n}}O=new WeakSet,U=function(t){return t.split(/\s+/).filter(Boolean)};class De{constructor(){h(this,"name");h(this,"action");h(this,"description");h(this,"params",{});h(this,"options",{});d(this,w,[]);d(this,p,{});d(this,g,[]);d(this,_,[]);d(this,y,[]);d(this,m,0);arguments.length>0&&(this.name=arguments[0])}Name(t){return this.name=t,this}Action(t){return this.action=t,this}Description(t){return this.description=t,this}Param(t){J(t);const n=t.name.replace(/\s+/g,"");return this.params[n]=t,f(this,w).push(f(this,m)),f(this,g).push(void 0),f(this,_).push(Y[t.type]),f(this,y).push(t.default),F(this,m,f(this,m)+1),this}Option(t){const n=t.name.replace(/\s+/g,"");return J(t),this.options[n]=t,f(this,p)["--"+t.name]=f(this,m),"short"in t&&(f(this,p)["-"+t.short]=f(this,m)),t.type==="Boolean"?(f(this,y).push(!1),f(this,g).push(!0)):(f(this,y).push(t.default),f(this,g).push(!1)),f(this,_).push(Y[t.type]),F(this,m,f(this,m)+1),this}call(t){const n=A(f(this,y));let i=0;t.push(void 0);for(let o=0;o<t.length-1;o++){const c=t[o];if(c in f(this,p)){const l=f(this,p)[c],b=f(this,_)[l];f(this,g)[l]?n[l]=!0:n[l]=b(t[++o])}else if(i===f(this,w).length){C("error: too many parameters");return}else{const l=f(this,w)[i++],b=f(this,_)[l];n[l]=b(c)}}const s=this.action(...n);Se(s)?Ee(s):z(s)?T(s):typeof s=="string"&&C(s)}}w=new WeakMap,p=new WeakMap,g=new WeakMap,_=new WeakMap,y=new WeakMap,m=new WeakMap;const V=18,D=28,Y={Number:parseInt,Float:parseFloat,String:e=>e},J=Te({description:""}),L=new Ce;u.setting={prompt:void 0,prompt_visibility:void 0,background_color:void 0,font_color:void 0,logging_interval:void 0};function Le(e){u.setting=e}const We="",Re={expose:["enter"],components:{LogLine:Ae},data(){return{log_lines:[],log_buffer:[],logging:!1,command:"",cursor_index:0,command_history:[],command_history_index:-1,complete_command:[],complete_index:-1,setting:{prompt:"WebTerminal> ",prompt_visibility:!0,logging_interval:24,background_color:x.GRAY,font_color:x.WHITE},terminal_width:void 0,terminal_height:void 0,terminal_line_length:void 0}},methods:{scroll_to_bottom(){setTimeout(()=>{this.$refs.terminal_window.scrollTop=this.$refs.terminal_window.scrollHeight})},log_to_buffer(e){if(typeof e=="string")this.log_buffer.push([k(e)]);else if(z(e)){for(let t=0;t<e.length;t++)typeof e[t]=="string"&&(e[t]=k(e[t]));this.log_buffer.push(e)}this.log_buffer.length>0&&!this.logging&&(this.logging=!0,this.buffer_to_log())},async buffer_to_log(){if(this.scroll_to_bottom(),this.log_buffer.length===0){this.logging=!1;return}this.log_buffer.length>0&&this.log_lines.push(this.log_buffer.shift()),setTimeout(this.buffer_to_log,this.setting.logging_interval)},enter(){this.logging||(C(this.command_line),L.execute(this.command),this.cursor_index=0,this.command_history.unshift(this.command),this.command_history_index=-1,this.$nextTick(()=>{this.command=""}))},history(e){e.key==="ArrowUp"?this.command_history_index<this.command_history.length-1&&(this.command_history_index++,this.command=this.command_history[this.command_history_index],this.cursor_to_end()):e.key==="ArrowDown"&&this.command_history_index>0&&(this.command_history_index--,this.command=this.command_history[this.command_history_index],this.cursor_to_end())},tab(){this.complete_index===-1&&(this.complete_command=L.complete(this.command)),this.complete_command.length!==0&&(this.complete_index=(this.complete_index+1)%this.complete_command.length,this.command=this.complete_command[this.complete_index],this.cursor_to_end())},cursor_to_end(){setTimeout(()=>{this.$refs.terminal_input.setSelectionRange(this.command.length,this.command.length),this.cursor_index=0})},keydown(e){e.key!=="Tab"&&(this.complete_command=[],this.complete_index=-1)},update_cursor_index(e){const t=e.target;setTimeout(()=>{this.cursor_index=t.value.length-t.selectionEnd})},focus(e){e&&(e.key==="Control"||e.ctrlKey&&e.key==="c")||this.$nextTick(()=>{this.$refs.terminal_input.focus()})}},watch:{"setting.background_color":function(e){const t=this.$el.parentElement;Object.assign(t.style,{"background-color":e})},"setting.font_color":function(e){console.log("font_color",e);const t=this.$el.parentElement;Object.assign(t.style,{color:e})}},computed:{command_line(){return this.setting.prompt_visibility?[k(this.setting.prompt+this.command)]:[k(this.command)]}},mounted(){this.resize_observer=new ResizeObserver(e=>{for(let t of e)t.target===this.$refs.terminal_window&&(this.terminal_width=t.contentRect.width,this.terminal_height=t.contentRect.height,this.terminal_line_length=Math.floor(this.terminal_width/we))}),this.resize_observer.observe(this.$refs.terminal_window),Be(this.log_to_buffer),Le(this.setting),this.focus()}};function Ne(e,t,n,i,s,o){const c=r.resolveComponent("LogLine");return r.openBlock(),r.createElementBlock(r.Fragment,null,[r.createElementVNode("div",{id:"terminal_window",ref:"terminal_window",onKeydown:t[0]||(t[0]=(...l)=>o.focus&&o.focus(...l)),tabindex:"0"},[(r.openBlock(!0),r.createElementBlock(r.Fragment,null,r.renderList(s.log_lines,l=>(r.openBlock(),r.createBlock(c,{log_line:l,terminal_line_length:s.terminal_line_length},null,8,["log_line","terminal_line_length"]))),256)),r.withDirectives(r.createVNode(c,{ref:"command_line",log_line:o.command_line,terminal_line_length:s.terminal_line_length,cursor_index:s.cursor_index},null,8,["log_line","terminal_line_length","cursor_index"]),[[r.vShow,!s.logging]])],544),r.withDirectives(r.createElementVNode("input",{id:"terminal_input",ref:"terminal_input","onUpdate:modelValue":t[1]||(t[1]=l=>s.command=l),onKeydown:[t[2]||(t[2]=r.withKeys((...l)=>o.update_cursor_index&&o.update_cursor_index(...l),["left","right"])),t[3]||(t[3]=r.withKeys((...l)=>o.history&&o.history(...l),["up","down"])),t[4]||(t[4]=r.withKeys((...l)=>o.enter&&o.enter(...l),["enter"])),t[5]||(t[5]=r.withKeys(r.withModifiers((...l)=>o.tab&&o.tab(...l),["prevent"]),["tab"])),t[6]||(t[6]=(...l)=>o.keydown&&o.keydown(...l))]},null,544),[[r.vModelText,s.command]])],64)}const Ie=K(Re,[["render",Ne],["__scopeId","data-v-04f42457"]]);u.Terminal=Ie,u.commanding=L,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})});
