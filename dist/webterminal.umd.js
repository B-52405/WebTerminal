var Fe=Object.defineProperty;var Pe=(l,r,a)=>r in l?Fe(l,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[r]=a;var h=(l,r,a)=>(Pe(l,typeof r!="symbol"?r+"":r,a),a),R=(l,r,a)=>{if(!r.has(l))throw TypeError("Cannot "+a)};var f=(l,r,a)=>(R(l,r,"read from private field"),a?a.call(l):r.get(l)),d=(l,r,a)=>{if(r.has(l))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(l):r.set(l,a)},N=(l,r,a,j)=>(R(l,r,"write to private field"),j?j.call(l,a):r.set(l,a),a);var I=(l,r,a)=>(R(l,r,"access private method"),a);(function(l,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],r):(l=typeof globalThis<"u"?globalThis:l||self,r(l.WebTerminal={},l.Vue))})(this,function(l,r){var O,F,w,p,g,_,y,m;"use strict";function a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var j=Object.prototype.toString,P=function(t){if(t===void 0)return"undefined";if(t===null)return"null";var n=typeof t;if(n==="boolean")return"boolean";if(n==="string")return"string";if(n==="number")return"number";if(n==="symbol")return"symbol";if(n==="function")return Z(t)?"generatorfunction":"function";if(J(t))return"array";if(te(t))return"buffer";if(ee(t))return"arguments";if(Q(t))return"date";if(q(t))return"error";if(X(t))return"regexp";switch(U(t)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(v(t))return"generator";switch(n=j.call(t),n){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return n.slice(8,-1).toLowerCase().replace(/\s/g,"")};function U(e){return typeof e.constructor=="function"?e.constructor.name:null}function J(e){return Array.isArray?Array.isArray(e):e instanceof Array}function q(e){return e instanceof Error||typeof e.message=="string"&&e.constructor&&typeof e.constructor.stackTraceLimit=="number"}function Q(e){return e instanceof Date?!0:typeof e.toDateString=="function"&&typeof e.getDate=="function"&&typeof e.setDate=="function"}function X(e){return e instanceof RegExp?!0:typeof e.flags=="string"&&typeof e.ignoreCase=="boolean"&&typeof e.multiline=="boolean"&&typeof e.global=="boolean"}function Z(e,t){return U(e)==="GeneratorFunction"}function v(e){return typeof e.throw=="function"&&typeof e.return=="function"&&typeof e.next=="function"}function ee(e){try{if(typeof e.length=="number"&&typeof e.callee=="function")return!0}catch(t){if(t.message.indexOf("callee")!==-1)return!0}return!1}function te(e){return e.constructor&&typeof e.constructor.isBuffer=="function"?e.constructor.isBuffer(e):!1}/*!
 * shallow-clone <https://github.com/jonschlinkert/shallow-clone>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Released under the MIT License.
 */const W=Symbol.prototype.valueOf,ne=P;function re(e,t){switch(ne(e)){case"array":return e.slice();case"object":return Object.assign({},e);case"date":return new e.constructor(Number(e));case"map":return new Map(e);case"set":return new Set(e);case"buffer":return ce(e);case"symbol":return le(e);case"arraybuffer":return oe(e);case"float32array":case"float64array":case"int16array":case"int32array":case"int8array":case"uint16array":case"uint32array":case"uint8clampedarray":case"uint8array":return se(e);case"regexp":return ie(e);case"error":return Object.create(e);default:return e}}function ie(e){const t=e.flags!==void 0?e.flags:/\w+$/.exec(e)||void 0,n=new e.constructor(e.source,t);return n.lastIndex=e.lastIndex,n}function oe(e){const t=new e.constructor(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t}function se(e,t){return new e.constructor(e.buffer,e.byteOffset,e.length)}function ce(e){const t=e.length,n=Buffer.allocUnsafe?Buffer.allocUnsafe(t):Buffer.from(t);return e.copy(n),n}function le(e){return W?Object(W.call(e)):{}}var ue=re;/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var fe=function(t){return t!=null&&typeof t=="object"&&Array.isArray(t)===!1};/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var ae=fe;function $(e){return ae(e)===!0&&Object.prototype.toString.call(e)==="[object Object]"}var he=function(t){var n,i;return!($(t)===!1||(n=t.constructor,typeof n!="function")||(i=n.prototype,$(i)===!1)||i.hasOwnProperty("isPrototypeOf")===!1)};const me=ue,de=P,pe=he;function S(e,t){switch(de(e)){case"object":return ge(e,t);case"array":return _e(e,t);default:return me(e)}}function ge(e,t){if(typeof t=="function")return t(e);if(t||pe(e)){const n=new e.constructor;for(let i in e)n[i]=S(e[i],t);return n}return e}function _e(e,t){const n=new e.constructor(e.length);for(let i=0;i<e.length;i++)n[i]=S(e[i],t);return n}var ye=S;const A=a(ye),x=Object.freeze({BLACK:"black",BLUE:"blue",GREEN:"green",RED:"red",YELLOW:"yellow",WHITE:"white",ORANGR:"orange",GRAY:"#282828"});class B{constructor(){h(this,"text","");h(this,"cls",[]);h(this,"style",{});h(this,"click");arguments.length>0&&(this.text=arguments[0])}Text(t){return this.text=t,this}Clss(t){return this.cls=t,this}Cls(t){return this.cls.push(t),this}Style(t){return this.style=t,this}Property(t,n){return this.style[t]=n,this}Click(t){return this.click=t,this}get length(){return this.text.length}copy(){return new B().Text(this.text).Clss(A(this.cls)).Style(A(this.style)).Click(this.click)}slice(t,n){t===void 0&&(t=0),n===void 0&&(n=this.length);const i=this.copy();return i.text=i.text.slice(t,n),i}warning(t){return this.text=t,this.style={color:x.ORANGR},this}error(t){return this.text=t,this.style={color:x.RED},this}red(){this.style.color=x.RED}}function k(){return arguments.length===0?new B:new B().Text(arguments[0])}const Ue="",M=(e,t)=>{const n=e.__vccOpts||e;for(const[i,s]of t)n[i]=s;return n},be={props:{log_line:Array,terminal_line_length:Number,cursor_index:Number},computed:{lines(){let e=this.terminal_line_length,t=[[]];if(this.log_line.forEach(n=>{if(e==0&&(t.push([]),e=this.terminal_line_length),n.length>e){const i=n.slice(0,e);let s=n.slice(e);for(t[t.length-1].push(i);s.length>this.terminal_line_length;)t.push([s.slice(0,this.terminal_line_length)]),s=s.slice(this.terminal_line_length);t.push([s]),e=this.terminal_line_length-n.length+e}else t[t.length-1].push(n.copy()),e-=n.length}),this.cursor_index===void 0)return t;if(this.cursor_index===0){const n=t[t.length-1],i=k(" ").Cls("cursor");return n.push(i),t}else{let n=this.cursor_index;for(let i=t.length-1;i>=0;i--){const s=t[i];for(let o=s.length-1;o>=0;o--){const u=s[o];if(u.length>=n){const c=u.length-n,b=u.slice(0,c),D=u.slice(c,c+1).Cls("cursor"),L=u.slice(c+1);return s.splice(o,1,b,D,L),t}else n-=u.length}}}return t}}},we={ref:"container"},xe={class:"log_line"},ke=["onClick"];function Oe(e,t,n,i,s,o){return r.openBlock(),r.createElementBlock("div",we,[(r.openBlock(!0),r.createElementBlock(r.Fragment,null,r.renderList(o.lines,u=>(r.openBlock(),r.createElementBlock("div",xe,[(r.openBlock(!0),r.createElementBlock(r.Fragment,null,r.renderList(u,({text:c,cls:b,style:D,click:L})=>(r.openBlock(),r.createElementBlock("p",{class:r.normalizeClass(["clause",b]),style:r.normalizeStyle(D),onClick:L},r.toDisplayString(c),15,ke))),256))]))),256))],512)}const je=M(be,[["render",Oe],["__scopeId","data-v-6e182a2c"]]);let T=console.log;function Ae(e){typeof e=="function"&&(T=e)}function G(e,t){for(let n of e)T(n);typeof t=="function"&&t()}function E(e,t){G([e],t)}async function Be(e,t){for(;;){const{value:n,done:i}=await e.next();if(i)break;T(n)}typeof t=="function"&&t()}function K(e){return Array.isArray(e)&&e.length>0}function z(e){return typeof e=="object"&&Object.keys(e).length>0}function Ee(e){return e==null||typeof e!="object"&&typeof e!="function"||typeof e.next!="function"||typeof e[Symbol.iterator]!="function"?!1:e[Symbol.iterator]()===e}function Se(e){return function(t){for(const n in e)t[n]===void 0&&(t[n]=A(e[n]))}}class Te{constructor(){d(this,O);h(this,"name","");h(this,"banner",[]);h(this,"description","");h(this,"commands",{})}Name(t){return this.name=t,this}Banner(t){return this.banner=t,this}Description(t){return this.description=t,this}Command(t){const n=new Ce(t);return this.commands[t.toLowerCase()]=n,n}Remove(t){delete this.commands[t]}complete(t){if(I(this,O,F).call(this,t).length!==1)return[];{const n=[],i=t.toLowerCase();for(let s in this.commands)s.startsWith(i)&&n.push(this.commands[s].name);return n.sort()}}execute(t){const n=I(this,O,F).call(this,t);if(n.length===0)return;const i=this.commands[n[0]];if(i===void 0){E("  No such command.");return}i.call(n.slice(1))}help(t){if(t===void 0){const s=["Commands:",""];for(const o in this.commands){const u=this.commands[o];let c=`  ${u.name}`;c+=" ".repeat(V-c.length)+u.description,s.push(c)}return s.push(""),s}if(!(t in this.commands))return"  No such command.";const n=[],i=this.commands[t];if(i.description!==void 0&&(n.push(`Description: ${i.description}`),n.push("")),z(i.params)){n.push("Params:");for(const s in i.params){const o=i.params[s];let u=`  ${o.name}`;u+=" ".repeat(V-u.length)+o.description,o.default!==void 0&&(u+=`(default: ${JSON.stringify(o.default)})`),n.push(u)}n.push("")}if(z(i.options)){n.push("Options:");for(const s in i.options){const o=i.options[s];let u="  ";"short"in o&&(u+=`-${o.short}, `),u+=`--${o.name}`,u+=" ".repeat(26-u.length)+o.description,o.default!==void 0&&(u+=`(default: ${JSON.stringify(o.default)})`),n.push(u)}n.push("")}return n}}O=new WeakSet,F=function(t){return t.split(/\s+/).filter(Boolean)};class Ce{constructor(){h(this,"name");h(this,"action");h(this,"description");h(this,"params",{});h(this,"options",{});d(this,w,[]);d(this,p,{});d(this,g,[]);d(this,_,[]);d(this,y,[]);d(this,m,0);arguments.length>0&&(this.name=arguments[0])}Name(t){return this.name=t,this}Action(t){return this.action=t,this}Description(t){return this.description=t,this}Param(t){Y(t);const n=t.name.replace(/\s+/g,"");return this.params[n]=t,f(this,w).push(f(this,m)),f(this,g).push(void 0),f(this,_).push(H[t.type]),f(this,y).push(t.default),N(this,m,f(this,m)+1),this}Option(t){const n=t.name.replace(/\s+/g,"");return Y(t),this.options[n]=t,f(this,p)["--"+t.name]=f(this,m),"short"in t&&(f(this,p)["-"+t.short]=f(this,m)),t.type==="Boolean"?(f(this,y).push(!1),f(this,g).push(!0)):(f(this,y).push(t.default),f(this,g).push(!1)),f(this,_).push(H[t.type]),N(this,m,f(this,m)+1),this}call(t){const n=A(f(this,y));let i=0;t.push(void 0);for(let o=0;o<t.length-1;o++){const u=t[o];if(u in f(this,p)){const c=f(this,p)[u],b=f(this,_)[c];f(this,g)[c]?n[c]=!0:n[c]=b(t[++o])}else if(i===f(this,w).length){E("error: too many parameters");return}else{const c=f(this,w)[i++],b=f(this,_)[c];n[c]=b(u)}}const s=this.action(...n);Ee(s)?Be(s):K(s)?G(s):typeof s=="string"&&E(s)}}w=new WeakMap,p=new WeakMap,g=new WeakMap,_=new WeakMap,y=new WeakMap,m=new WeakMap;const V=26,H={Number:parseInt,Float:parseFloat,String:e=>e},Y=Se({description:""}),C=new Te;l.terminal_setting={prompt:void 0,prompt_visibility:void 0,background_color:void 0,font_color:void 0,logging_interval:void 0};function De(e){l.terminal_setting=e}const We="",Le=10.8,Re={expose:["enter"],components:{LogLine:je},data(){return{log_lines:[],log_buffer:[],logging:!1,command:"",command_history:[],command_history_index:-1,cursor_index:0,setting:{prompt:"WebTerminal> ",prompt_visibility:!0,logging_interval:24,background_color:x.GRAY,font_color:x.WHITE},complete_command:[],complete_index:-1,terminal_width:void 0,terminal_height:void 0,terminal_line_length:void 0}},methods:{scroll_to_bottom(){setTimeout(()=>{this.$refs.terminal_window.scrollTop=this.$refs.terminal_window.scrollHeight})},log_to_buffer(e){if(typeof e=="string")this.log_buffer.push([k(e)]);else if(K(e)){for(let t=0;t<e.length;t++)typeof e[t]=="string"&&(e[t]=k(e[t]));this.log_buffer.push(e)}this.log_buffer.length>0&&!this.logging&&(this.logging=!0,this.buffer_to_log())},async buffer_to_log(){if(this.scroll_to_bottom(),this.log_buffer.length===0){this.logging=!1;return}this.log_buffer.length>0&&this.log_lines.push(this.log_buffer.shift()),setTimeout(this.buffer_to_log,this.setting.logging_interval)},enter(){this.logging||(E(this.command_line),C.execute(this.command),this.command_history.unshift(this.command),this.command_history_index=-1,this.$nextTick(()=>{this.command=""}))},history(e){e.key==="ArrowUp"?this.command_history_index<this.command_history.length-1&&(this.command_history_index++,this.command=this.command_history[this.command_history_index]):e.key==="ArrowDown"&&this.command_history_index>0&&(this.command_history_index--,this.command=this.command_history[this.command_history_index])},tab(){this.complete_index===-1&&(this.complete_command=C.complete(this.command)),this.complete_command.length!==0&&(this.complete_index=(this.complete_index+1)%this.complete_command.length,this.command=this.complete_command[this.complete_index])},keydown(e){e.key!=="Tab"&&(this.complete_command=[],this.complete_index=-1)},update_cursor_index(e){const t=e.target;setTimeout(()=>{this.cursor_index=t.value.length-t.selectionEnd})},focus(e){e&&(e.key==="Control"||e.ctrlKey&&e.key==="c")||this.$nextTick(()=>{this.$refs.terminal_input.focus()})}},watch:{"setting.background_color":function(e){const t=this.$el.parentElement;Object.assign(t.style,{"background-color":e})},"setting.font_color":function(e){console.log("font_color",e);const t=this.$el.parentElement;Object.assign(t.style,{color:e})}},computed:{command_line(){return this.setting.prompt_visibility?[k(this.setting.prompt+this.command)]:[k(this.command)]}},mounted(){this.resize_observer=new ResizeObserver(e=>{for(let t of e)t.target===this.$refs.terminal_window&&(this.terminal_width=t.contentRect.width,this.terminal_height=t.contentRect.height,this.terminal_line_length=Math.floor(this.terminal_width/Le))}),this.resize_observer.observe(this.$refs.terminal_window),Ae(this.log_to_buffer),De(this.setting),this.focus()}};function Ne(e,t,n,i,s,o){const u=r.resolveComponent("LogLine");return r.openBlock(),r.createElementBlock(r.Fragment,null,[r.createElementVNode("div",{ref:"terminal_window",onKeydown:t[0]||(t[0]=(...c)=>o.focus&&o.focus(...c)),tabindex:"0"},[(r.openBlock(!0),r.createElementBlock(r.Fragment,null,r.renderList(s.log_lines,c=>(r.openBlock(),r.createBlock(u,{log_line:c,terminal_line_length:s.terminal_line_length},null,8,["log_line","terminal_line_length"]))),256)),r.withDirectives(r.createVNode(u,{ref:"command_line",log_line:o.command_line,terminal_line_length:s.terminal_line_length,cursor_index:s.cursor_index},null,8,["log_line","terminal_line_length","cursor_index"]),[[r.vShow,!s.logging]])],544),r.withDirectives(r.createElementVNode("input",{ref:"terminal_input","onUpdate:modelValue":t[1]||(t[1]=c=>s.command=c),onKeydown:[t[2]||(t[2]=r.withKeys((...c)=>o.update_cursor_index&&o.update_cursor_index(...c),["left","right"])),t[3]||(t[3]=r.withKeys((...c)=>o.history&&o.history(...c),["up","down"])),t[4]||(t[4]=r.withKeys((...c)=>o.enter&&o.enter(...c),["enter"])),t[5]||(t[5]=r.withKeys(r.withModifiers((...c)=>o.tab&&o.tab(...c),["prevent"]),["tab"])),t[6]||(t[6]=(...c)=>o.keydown&&o.keydown(...c))]},null,544),[[r.vModelText,s.command]])],64)}const Ie=M(Re,[["render",Ne],["__scopeId","data-v-78e024b9"]]);l.Terminal=Ie,l.commanding=C,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
